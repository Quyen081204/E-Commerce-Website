{%extends 'layout/base.html'%}

{%block title%}Gio hang{%endblock%}

{%block content%}
<h1 class="text-center text-danger mb-3 mt-3">GIO HANG</h1>

{% if session.get('cart')%}
<table class="table" id="table_cart_id">
    <tr>
        <th>Ma san pham</th>
        <th>Ten san pham</th>
        <th>Don gia</th>
        <th>So luong</th>
    </tr>

    {%for k in session.get('cart').keys():%}
    {% if k != 'total_quantity' and k != 'total_amount'%}
    <tr>
        <td>{{session.get('cart').get(k).id}}</td>
        <td>{{session.get('cart').get(k).name}}</td>
        <td>{{session.get('cart').get(k).price}}</td>
        <td>
                <div class="form-group mb-0">
                <input type="number" class="form-control" value="{{session.get('cart').get(k).quantity}}" min="1" onblur="updateCart({{session.get('cart').get(k).id}},this)">
                </div>
        </td>
        <td>
            <input type="button" value="Xoa" class="btn btn-danger" onclick="removeItem({{session.get('cart').get(k).id}},this)">
        </td>
    </tr>

    {%endif%}
    {%endfor%}
</table>
<div class="alert alert-info">
    <p class="m-0">Tong so san pham: <span class="cart_counter">{{session.get('cart').get('total_quantity')}}</span></p>
    <p class="m-0">Tong thanh tien: <span id="total_amount">{{'{:,d}'.format(session.get('cart').get('total_amount'))}}</span> VND</p>
</div>
{% if current_user.is_authenticated %}
<input type="submit" value="Thanh toan" class="btn btn-info" onclick="pay()"/>
{% else %}
<a href="{{url_for('user_signin', next='cart')}}">Dang nhap</a>
{%endif%}
{%else%}
<h5><i>Khong co san pham nao</i></h5>
{%endif%}

{%endblock%}